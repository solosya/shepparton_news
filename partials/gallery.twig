{% set type = type is defined ? type : "image" %}

{% set galleryStyle = galleryStyle is defined ? galleryStyle  : "article" %}

{% set owl = '' %}
{% set owlClass = '' %}

{% if ( media | length > 1 ) %}
    {% set owl = "owl-gallery-" ~ type %}
    {% set owlClass = 'owl-carousel owl-shep-theme owl-carousel__base'%}
{% endif %}

{% set defaultClass = default is defined and default == true ? "default" : "" %}



<div id="{{owl}}" class="owl-gallery-{{type}} {{owlClass}} {{defaultClass}}">
    {% for image in media %}
        {% set articleImg = _Media.getMediaUrl(image,1094, 515, {'crop': 'fill', 'gravity': 'auto'} ) %}

        <figure class="{{galleryStyle}}-featured-image">
            <img src="{{articleImg}}" class="{{galleryStyle}}-featured-image__img">
            {% if image.type == 'video' %} 
                {% set mediaUrl = "" %}

                {% if image.isSystemVideo == 'TRUE'%}
                    {% set mediaUrl = _Media.getMediaVideoUrl(image, 0, 0,{resource_type: 'video', format: 'mp4'})  %}

                    <a  href            = "javascript:void(0)" 
                        itemprop        = "video" 
                        class           = "video-overlay video-player article-video"
                        data-source     = "{{image.source}}" 
                        data-video-id   = "{{image.videoId}}" 
                        data-url        = "{{mediaUrl}}" 
                        data-poster     = "{{image.path}}" 
                        data-caption    = "{{article.title | raw}}">
                        
                        {# <div class="icons">
                            <div class="icon">
                                <i class="fa fa-play"></i>
                            </div>
                        </div>  #}

                        <video controls class="article-video__player" poster="{{image.path}}">
                        {# <source src="{{mediaUrl}}" type="video/webm"/> #}
                        <source src="{{mediaUrl}}" type="video/mp4"/>
                        {# <source src="{{mediaUrl}}" type="video/ogg"/> #}
                        </video>

                         {# <iframe class="article-video__player" src="{{mediaUrl}}?autoplay=false"  frameborder="0" allowfullscreen></iframe> #}
                    </a>

                {# {% else %}

                    {% if media.source == 'youtube' %}
                        {% set mediaUrl = "https://www.youtube.com/embed/" ~ media.videoId  %}
                    {% else %}
                        {% set mediaUrl = "http://player.vimeo.com/video/" ~ media.videoId  %}
                    {% endif %}

                    <a href="javascript:void(0)" itemprop="video" class="video-overlay" data-source="{{media.source}}" data-url="{{mediaUrl}}"  data-video-id="{{media.videoId}}" data-poster="{{media.path}}" data-caption="{{article.title | raw}}">
                        <iframe class="slick-video" src="{{mediaUrl}}" frameborder="0" allowfullscreen></iframe>
                    </a> #}

                {% endif %}


            {% endif %}
            <figcaption>
                <p class="{{galleryStyle}}-featured-image__caption">{{image.caption}}</p>
            </figcaption>
        </figure>
    {% endfor %}
</div>
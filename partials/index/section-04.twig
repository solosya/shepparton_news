{% set articleCount = 0 %}
{% set cardIndex = 1 %}

<div class="row">
    <div class="col-sm-9 section-header">
        <p><a href="{{link}}">View All</a></p>
        <div class="hk">
            <h2>{{ title }}</h2>
            <p></p>
        </div>
    </div>
</div>




{# ********************
        ROW 1
******************** #}

<div class="row">
    <div class="col-xs-9 col-sm-9 col-md-6">
        
        {# Card 1 #}
        {% if articles[articleCount] %}                                                                
            {{this.render('../_single-article.twig', {
                article         : articles[articleCount], 
                imageSize       : {width:640, height:400},
                site            : site,
                swap            : false,
                dev             : dev,
                position        : cardIndex,
                containerClass  : 'home-feature home-feature-tablet home-feature-mobile'
            }) | raw}}
            {% set articleCount = (dev) ? articleCount : articleCount + 1 %}
            {% set cardIndex = cardIndex + 1 %}

        {% endif %}




        {# ********************
                ROW 2
        ******************** #}

        <div class="row u-margin-top-30 two-cols-tablet-up">

            {# Cards 2,3 #}
            {% for i in 0..1 if articles[articleCount] %}
                {% set theDivider = [' divideright',''] %}
                    
                {% if i == 0 %}
                    <div class="col-sm-1 col-xs-9">
                {% else %}
                    <div class="col-sm-1 col-xs-9">
                {% endif %}
                
                    {{this.render('../_single-article.twig', {
                        article         : articles[articleCount],
                        imageSize       : {width:95},
                        site            : site,
                        swap            : false,
                        dev             : dev,
                        position        : cardIndex,
                        containerClass  : 'feature-side feature-side-tablet card-sm-mobile' ~ theDivider[i]
                    }) | raw}}
                    {% set articleCount = (dev) ? articleCount : articleCount + 1 %}
                    {% set cardIndex = cardIndex + 1 %}
                    <hr class="divide visible-xs-block">
                </div>
            {% endfor %}
        </div>



        {# ********************
                ROW 3
        ******************** #}

        <div class="row u-margin-top-40 two-cols-tablet u-mobile-no-margin-top">


            {# Cards 4 #}
            {% if articles[articleCount] %}     
                <div class="col-sm-1 col-md-6 col-xs-9">
                    {{this.render('../_single-article.twig', {
                        article         : articles[articleCount],
                        imageSize       : {width:414, height:255},
                        site            : site,
                        swap            : false,
                        dev             : dev,
                        position        : cardIndex,
                        containerClass  : 'home-feature-xs feature-side-tablet home-feature-mobile divideright'
                    }) | raw}}
                    {% set articleCount = (dev) ? articleCount : articleCount + 1 %}
                    {% set cardIndex = cardIndex + 1 %}
                    <hr class="divide visible-xs-block">
                </div>
            {% endif %}


            {# Cards 5 #}
            {% if articles[articleCount] %}     
                <div class="col-sm-1 col-md-3 col-xs-9">
                    {{this.render('../_single-article.twig', {
                        article         : articles[articleCount],
                        imageSize       : {width:195},
                        site            : site,
                        swap            : false,
                        dev             : dev,
                        position        : cardIndex,
                        containerClass  : 'card-sm feature-side-tablet card-sm-mobile'
                    }) | raw}}
                    {% set articleCount = (dev) ? articleCount : articleCount + 1 %}
                    {% set cardIndex = cardIndex + 1 %}
                    <div class="row">
                        <hr class="divide visible-xs-block">
                    </div>
                </div>
            {% endif %}
        </div>

    </div>







{# ********************
        Column 2
******************** #}
    <div class="col-xs-9 col-sm-9 col-md-3 sm-two-cols">
        <div class="row u-tablet-margin-top-30 sm-two-cols">
            <div class="col-md-9 col-sm-1 col-xs-9 ad-square u-margin-bottom-30 u-mobile-no-margin-bottom">
                 <div class='advert-desktop advert-mobile advert-tablet' data-adsize="mrec"></div>
            </div>

            <hr class="divide visible-xs-block">


            {# Cards 6,7,8,9 #}
            {% for i in 0..3 if articles[articleCount] %}
                <div class="col-md-9 col-sm-1 col-xs-9">
                    {% set theDivide = ['','',' divideright',''] %}
                    {{this.render('../_single-article.twig', {
                        article         : articles[articleCount],
                        imageSize       : {width:95},
                        site            : site,
                        swap            : false,
                        dev             : dev,
                        position        : cardIndex,
                        containerClass  : 'feature-side feature-side-tablet card-sm-mobile' ~ theDivide[i]
                    }) | raw}}
                    {% set articleCount = (dev) ? articleCount : articleCount + 1 %}
                    {% set cardIndex = cardIndex + 1 %}

                    {% if i < 2 %}
                        <hr class="divide visible-xs-block">
                        <hr class="divide24 hidden-xs">
                    {% elseif i == 2 %}
                        <hr class="divide visible-xs-block">
                        <hr class="divide24 hidden-xs hidden-sm">
                    {% endif %}
                </div>

            {% endfor %}
        </div>
    </div>
</div>